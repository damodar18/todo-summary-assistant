
declare module 'mongoose' {
  import mongodb = require('mongodb');
  import bson = require('bson');

  class NativeBuffer extends Buffer {}

  namespace Types {
    class Array<T> extends global.Array<T> {
      
      $pop(): T;

      
      $shift(): T;

      
      addToSet(...args: any[]): any[];

      isMongooseArray: true;

      
      nonAtomicPush(...args: any[]): number;

      
      push(...args: any[]): number;

      /**
       * Pulls items from the array atomically. Equality is determined by casting
       * the provided value to an embedded document and comparing using
       * [the `Document.equals()` function.](./api/document.html#document_Document-equals)
       */
      pull(...args: any[]): this;

      /**
       * Alias of [pull](#mongoosearray_MongooseArray-pull)
       */
      remove(...args: any[]): this;

      
      set(index: number, val: T): this;

      
      shift(): T;

      
      toObject(options?: ToObjectOptions): any;
      toObject<T>(options?: ToObjectOptions<T>): T;

      
      unshift(...args: any[]): number;
    }

    class Buffer extends NativeBuffer {
      
      subtype(subtype: 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 128 | ToObjectOptions): void;

      
      toObject(subtype?: 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 128): mongodb.Binary;
    }

    class Decimal128 extends mongodb.Decimal128 { }

    class DocumentArray<T, THydratedDocumentType extends Types.Subdocument<any, any, T> = Types.Subdocument<InferId<T>, any, T> & T> extends Types.Array<THydratedDocumentType> {
      
      constructor(values: AnyObject[]);

      isMongooseDocumentArray: true;

      
      create(obj: any): THydratedDocumentType;

      
      id(id: ObjectId | string | number | Buffer): THydratedDocumentType | null;

      push(...args: (AnyKeys<T> & AnyObject)[]): number;

      splice(start: number, deleteCount?: number, ...args: (AnyKeys<T> & AnyObject)[]): THydratedDocumentType[];
    }

    class Map<V> extends global.Map<string, V> {
      
      toObject(options?: ToObjectOptions & { flattenMaps?: boolean }): any;
    }

    class ObjectId extends mongodb.ObjectId {
    }

    class Subdocument<IdType = any, TQueryHelpers = any, DocType = any> extends Document<IdType, TQueryHelpers, DocType> {
      $isSingleNested: true;

      
      ownerDocument(): Document;

      
      parent(): Document;

      
      $parent(): Document;
    }

    class ArraySubdocument<IdType = any, TQueryHelpers = unknown, DocType = unknown> extends Subdocument<IdType, TQueryHelpers, DocType> {
      
      parentArray(): Types.DocumentArray<unknown>;
    }

    class UUID extends bson.UUID {}

    class Double extends bson.Double {}
  }
}
