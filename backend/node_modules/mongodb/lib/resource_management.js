"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.configureResourceManagement = configureResourceManagement;
exports.configureExplicitResourceManagement = configureExplicitResourceManagement;

function configureResourceManagement(target) {
    Symbol.asyncDispose &&
        Object.defineProperty(target, Symbol.asyncDispose, {
            value: async function asyncDispose() {
                await this.asyncDispose();
            },
            enumerable: false,
            configurable: true,
            writable: true
        });
}
/**
 * @beta
 * @experimental
 *
 * Attaches `Symbol.asyncDispose` methods to the MongoClient, Cursors, sessions and change streams
 * if Symbol.asyncDispose is defined.
 *
 * It's usually not necessary to call this method - the driver attempts to attach these methods
 * itself when its loaded.  However, sometimes the driver may be loaded before `Symbol.asyncDispose`
 * is defined, in which case it is necessary to call this method directly.  This can happen if the
 * application is polyfilling `Symbol.asyncDispose`.
 *
 * Example:
 *
 * ```typescript
 * import { configureExplicitResourceManagement, MongoClient } from 'mongodb/lib/beta';
 *
 * Symbol.asyncDispose ??= Symbol('dispose');
 * load();
 *
 * await using client = new MongoClient(...);
 * ```
 */
function configureExplicitResourceManagement() {





    const { MongoClient } = require('./mongo_client');

    const { ClientSession } = require('./sessions');

    const { AbstractCursor } = require('./cursor/abstract_cursor');

    const { ChangeStream } = require('./change_stream');
    configureResourceManagement(MongoClient.prototype);
    configureResourceManagement(ClientSession.prototype);
    configureResourceManagement(AbstractCursor.prototype);
    configureResourceManagement(ChangeStream.prototype);
}

